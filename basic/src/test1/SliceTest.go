package test1

import (
	"errors"
	"gostudy/algorithm/src/util"
	"log"
	"reflect"

	// "runtime"
	"unsafe"
)

/*
	sliceå¹¶éåŠ¨æ€æ•°ç»„æˆ–è€…æ•°ç»„æŒ‡é’ˆã€‚å®ƒé€šè¿‡å†…éƒ¨æŒ‡é’ˆå¼•ç”¨åº•å±‚æ•°ç»„ï¼Œè®¾å®šç›¸å…³å±æ€§å°†æ•°æ®è¯»å†™æ“ä½œé™å®šåœ¨æŒ‡å®šåŒºåŸŸå†…
	sliceæœ¬èº«æ˜¯ä¸€ä¸ªåªè¯»å¯¹è±¡ï¼Œå…¶å·¥ä½œæœºåˆ¶ç±»ä¼¼äºæ•°ç»„æŒ‡é’ˆçš„ä¸€ç§åŒ…è£…
	ç»“æ„å¦‚ä¸‹ï¼š
	type slice struct {
		array unsafe.Printer
		len int
		cap int
	}
	åˆ‡ç‰‡ä¸æ”¯æŒæ¯”è¾ƒæ“ä½œï¼Œç±»å‹ç›¸åŒä¹Ÿä¸è¡Œï¼Œåªèƒ½ä¸nilè¿›è¡Œæ¯”è¾ƒã€‚
	å¦‚ä½•åŒºåˆ†æ•°ç»„å’Œåˆ‡ç‰‡ï¼š
	 	Â·æ•°ç»„éœ€è¦å›ºå®šé•¿åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç¡®å®šäº†é•¿åº¦ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰ï¼Œé‚£ä¹ˆåˆå§‹åŒ–çš„å°±æ˜¯ä¸€ä¸ªæ•°ç»„
	  å¦‚æœåœ¨åˆå§‹åŒ–çš„æ—¶å€™æ²¡æœ‰ç¡®å®šé•¿åº¦ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼š
	  	[2]int{} // æ•°ç»„
	  	[...]int{} // æ•°ç»„ï¼Œè™½ç„¶æ²¡æœ‰æ˜¾å¼çš„å†™å…ƒç´ ä¸ªæ•°ï¼Œä½†æ˜¯...è¡¨ç¤ºç”±ç¼–è¯‘å™¨æ ¹æ®å…ƒç´ çš„ä¸ªæ•°æ¥ç¡®å®šæ•°ç»„é•¿åº¦ï¼Œä¹Ÿæ˜¯å®šé•¿ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„
	  	[]int{} // åˆ‡ç‰‡
	æ€§èƒ½æ–¹é¢ï¼š
		Â·åˆ‡ç‰‡å¯ä»¥ç”¨æ¥ä»£æ›¿æ•°ç»„ä¼ å‚ï¼Œé¿å…å¤åˆ¶çš„å¼€é”€
		Â·åˆ‡ç‰‡åº•å±‚æ•°ç»„å¯èƒ½åˆ†é…åœ¨å †ä¸Šï¼Œè€Œä¸”å°æ•°ç»„åœ¨æ ˆæ‹·è´ä¸Šæ¶ˆè€—æœªå¿…æ¯”makeä»£ä»·å¤§
	æ³¨æ„ï¼š
	    å¦‚æœåˆå§‹åŒ–æ—¶å†™çš„æ˜¯ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œé‚£ä¹ˆæ•°ç»„å°±ä¼šè¢«å¡«å……ä¸ºè¯¥ç±»å‹çš„åˆå§‹åŒ–å€¼
		ä¾‹å¦‚ï¼švar s = make([]int, 2, 5) å°±ä¼šå¡«å……2ä¸ª0ï¼Œappendçš„æ—¶å€™ä¼šå¾€åæ‰©å±•ï¼Œå³ä»3å¼€å§‹æ‰©å±•

*/
func SliceAppendTest() {
	// åˆå§‹åŒ–ä¸€ä¸ªsliceï¼Œ1è¡¨ç¤ºå½“å‰æ•°ç»„å…ƒç´ ä¸ªæ•°ï¼Œåˆå§‹åŒ–ä¸º0ï¼Œ3ä¸ºæœ€å¤§å®¹é‡
	var s = make([]int, 1, 3)
	log.Printf("s: %+v,%d \n", s, unsafe.Sizeof(s))
	s[0] = 1
	var s1 = append(s, 1)
	log.Printf("s: %+v,%d,cap: %d \n", s, unsafe.Sizeof(s), cap(s))
	log.Printf("s1: %+v,%d,cap: %d \n", s1, unsafe.Sizeof(s), cap(s1))
	// s1 appendä¹‹åï¼Œsliceé•¿åº¦å˜ä¸º2 æ²¡æœ‰è¶…è¿‡3ï¼Œå› æ­¤s1åº•å±‚çš„æ•°ç»„å…ƒç´ å’Œsçš„æ•°ç»„å…ƒç´ æ˜¯å…±äº«çš„ï¼Œå› æ­¤s1[0]æ”¹å˜ï¼Œs[0]ä¹Ÿä¼šæ”¹å˜
	s1[0] = 2
	log.Printf("s: %+v,%d,cap: %d \n", s, unsafe.Sizeof(s), cap(s))
	log.Printf("s1: %+v,%d,cap: %d \n", s1, unsafe.Sizeof(s), cap(s1))
	// éƒ½ä»¥sä¸ºappendçš„å¯¹è±¡çš„æ—¶å€™ï¼Œs3ä¼šè¦†ç›–s2æ‰€æ‰©å±•çš„å…ƒç´ ï¼Œæ‰€ä»¥s2å’Œs3æ‰“å°å…ƒç´ éƒ½ä¸º 3
	var s2 = append(s, 2)
	var s3 = append(s, 3)
	log.Printf("s2: %+v,%d,cap: %d \n", s2, unsafe.Sizeof(s2), cap(s2))
	log.Printf("s3: %+v,%d,cap: %d \n", s3, unsafe.Sizeof(s3), cap(s3))
	// s4 åŸºäºs3è¿›è¡Œæ‰©å®¹ æ‰€ä»¥å®¹é‡æ‰©åˆ°3ï¼Œs5åŸºäºs4æ‰©å®¹ï¼Œå®¹é‡æ‰©åˆ°4
	var s4 = append(s3, 4)
	var s5 = append(s4, 5)
	log.Printf("s4: %+v,%d,cap: %d \n", s4, unsafe.Sizeof(s4), cap(s4))
	log.Printf("s5: %+v,%d,cap: %d \n", s5, unsafe.Sizeof(s5), cap(s5))
	/*
		ç”±äºåˆå§‹åŒ–çš„æ—¶å€™ï¼Œæ€»å®¹é‡åˆå§‹åŒ–ä¸º3ï¼Œå› æ­¤å½“s4æ‰©å®¹å®Œæˆåï¼Œåˆšå¥½è¾¾åˆ°æ€»å®¹é‡3ï¼Œ
		æ‰€ä»¥æ­¤æ—¶ï¼Œs4å’Œs3ã€s2ã€s1ã€sæ˜¯å…±äº«å†…å­˜çš„ï¼Œæ‰€ä»¥ä¿®æ”¹äº†s4[0]ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ
		s3ã€s2ã€s1ã€sçš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¹Ÿä¼šåŒæ—¶æ”¹å˜
		ä½†æ˜¯å½“s5æ‰©å±•æ—¶ï¼Œå®¹é‡è¶…è¿‡äº†3ï¼Œå˜ä¸ºäº†4ï¼Œå› æ­¤s5æ‰©å±•æŒ‡å‘äº†æ–°çš„åˆ‡ç‰‡ï¼Œä¹Ÿå°±æ˜¯æ–°çš„å†…å­˜ç©ºé—´ï¼Œ
		å› æ­¤ä¿®æ”¹s5[0]ä¸ä¼šå½±å“s3ã€s2ã€s1ã€sã€s4
	*/
	s4[0] = 444
	s5[0] = 555
	log.Printf(" s: %+v,%d,cap: %d \n", s, unsafe.Sizeof(s), cap(s))
	log.Printf("s1: %+v,%d,cap: %d \n", s1, unsafe.Sizeof(s1), cap(s1))
	log.Printf("s2: %+v,%d,cap: %d \n", s2, unsafe.Sizeof(s2), cap(s2))
	log.Printf("s3: %+v,%d,cap: %d \n", s3, unsafe.Sizeof(s3), cap(s3))
	log.Printf("s4: %+v,%d,cap: %d \n", s4, unsafe.Sizeof(s4), cap(s4))
	log.Printf("s5: %+v,%d,cap: %d \n", s5, unsafe.Sizeof(s5), cap(s5))
	// s4ä»ç„¶å’Œs3,s2,s1,så…¬ç”¨æ•°ç»„ï¼Œä¸”ä¸s5äº’ä¸ç›¸å…³
	s4[0] = 666
	log.Printf(" s: %+v,%d,cap: %d \n", s, unsafe.Sizeof(s), cap(s))
	log.Printf("s1: %+v,%d,cap: %d \n", s1, unsafe.Sizeof(s1), cap(s1))
	log.Printf("s2: %+v,%d,cap: %d \n", s2, unsafe.Sizeof(s2), cap(s2))
	log.Printf("s3: %+v,%d,cap: %d \n", s3, unsafe.Sizeof(s3), cap(s3))
	log.Printf("s4: %+v,%d,cap: %d \n", s4, unsafe.Sizeof(s4), cap(s4))
	log.Printf("s5: %+v,%d,cap: %d \n", s5, unsafe.Sizeof(s5), cap(s5))
}

/*
	å¯ä»¥åŸºäºæ•°ç»„æˆ–è€…æ•°ç»„æŒ‡é’ˆåˆ›å»ºåˆ‡ç‰‡ï¼Œä»¥å¼€å§‹å’Œç»“æŸç´¢å¼•ä½ç½®ç¡®å®šæ‰€å¼•ç”¨çš„æ•°ç»„ç‰‡æ®µã€‚
	ä¸æ”¯æŒåå‘ç´¢å¼•ï¼Œå®é™…èŒƒå›´æ˜¯ä¸€ä¸ªå³åŠå¼€åŒºé—´ï¼ˆå·¦é—­å³å¼€ï¼ŒåŒ…å·¦ä¸åŒ…å³ï¼‰ä¾‹å¦‚ a[2:5] è¡¨ç¤º ä¸‹æ ‡[2,5)

	ç”Ÿæˆè§„åˆ™ï¼Œä»¥ a[2:5:3] ä¸ºä¾‹ï¼Œåˆ‡ç‰‡æŒ‡é’ˆæŒ‡å‘a[2]
		     low         high    max
              â†“           â†“       â†“
	+---+---+---+---+---+---+---+---+---+---+----+            +-----+---+---+---+
	| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |            | ptr | 2 | 3 | 4 |
	+---+---+---+---+---+---+---+---+---+---+----+            +-----+---+---+---+
	          â†‘<- len:3 ->â†‘       â†‘                              |
	          |<--     cap:5   -->|                              |
	          |------------------------------- array point ------|

*/
func SliceCreateTest() {
	a := [...]int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
	log.Printf("æ•°ç»„å˜é‡[a]åœ°å€ä¸º: %p, å€¼ä¸º: %d \n", &a, a)
	s0 := a[:]
	log.Printf("åˆ‡ç‰‡å˜é‡[s0](a[:])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s0, s0, len(s0), cap(s0))
	s1 := a[2:5]
	log.Printf("åˆ‡ç‰‡å˜é‡[s1](a[2:5])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s1, s1, len(s1), cap(s1))
	// low: 2, high: 5,max: 7 å› æ­¤ len = high-low, cap = max-low
	// pointer -> a[2]
	s2 := a[2:5:7]
	log.Printf("åˆ‡ç‰‡å˜é‡[s2](a[2:5:7])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s2, s2, len(s2), cap(s2))
	s3 := a[4:]
	log.Printf("åˆ‡ç‰‡å˜é‡[s3](a[4:])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s3, s3, len(s3), cap(s3))
	s4 := a[:4]
	log.Printf("åˆ‡ç‰‡å˜é‡[s4](a[:4])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s4, s4, len(s4), cap(s4))
	s5 := a[:4:6]
	log.Printf("åˆ‡ç‰‡å˜é‡[s5](a[:4:6])åœ°å€ä¸º: %p, å€¼ä¸º: %d, é•¿åº¦ä¸º: %d, å®¹é‡ä¸º: %d \n", &s5, s5, len(s5), cap(s5))

	/*
		ä¸‹é¢ä¸¤ç§æ–¹æ³•åˆå§‹åŒ–ä¸åŒåœ¨äºï¼š
		s6 *æ²¡æœ‰*ä¸º sliceå†…éƒ¨æŒ‡é’ˆèµ‹å€¼ï¼Œä½†æ˜¯å·²ç»åˆ†é…äº†æ‰€éœ€çš„å†…å­˜
		s7 *å·²ç»*ä¸ºsliceå†…éƒ¨çš„æŒ‡é’ˆèµ‹å€¼ï¼ŒæŒ‡é’ˆæŒ‡å‘ runtime.zerobaseï¼Œå¹¶ä¸”åˆ†é…äº†æ‰€éœ€çš„å†…å­˜
	*/
	var s6 []int
	s7 := []int{}
	// log.Printf("runtime.zerobase address: %p", runtime.GetZeroBasePtr())
	log.Printf("s6 address: %p \n", s6)
	log.Printf("s6 slice header: %#v, size: %d \n", (*reflect.SliceHeader)(unsafe.Pointer(&s6)), unsafe.Sizeof(s6))
	log.Printf("s7 address: %p \n", s7)
	log.Printf("s7 slice header: %#v, size: %d  \n", (*reflect.SliceHeader)(unsafe.Pointer(&s7)), unsafe.Sizeof(s6))

}

/*
	æ•°ç»„ä¸åˆ‡ç‰‡æ¯”è¾ƒ
	å¯ä»¥çœ‹åˆ°ï¼Œï¼ˆæ•°ç»„ï¼‰&s8 å¤´åœ°å€å°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ï¼Œè€Œï¼ˆåˆ‡ç‰‡ï¼‰&s9 å¤´åœ°å€ä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€
*/
func DiffBetweenArrayAndSlice() {
	/************ æ•°ç»„ *************/
	s8 := [...]int{0, 1, 2, 3, 4, 5}
	// è·å–headeråœ°å€
	p8 := &s8
	// è·å–å…ƒç´ åœ°å€
	p80 := &s8[0]
	p81 := &s8[1]
	log.Printf("æ•°ç»„[s8]å¤´åœ°å€ä¸º: %p, å¤´2ä¸ªå…ƒç´ åœ°å€ä¸º: [%p %p]", p8, p80, p81)
	// å…ƒç´ æ“ä½œ
	(*p8)[0] += 100
	*p81 += 100
	log.Printf("æ•°ç»„[s8]å€¼: %+v", p8)

	/************ åˆ‡ç‰‡ *************/
	s9 := []int{0, 1, 2, 3, 4, 5}
	// è·å–headeråœ°å€
	p9 := &s9
	// è·å–å…ƒç´ åœ°å€
	p90 := &s9[0]
	p91 := &s9[1]
	log.Printf("åˆ‡ç‰‡[s9]å¤´åœ°å€ä¸º: %p, å¤´2ä¸ªå…ƒç´ åœ°å€ä¸º: [%p %p]", p9, p90, p91)
	// å…ƒç´ æ“ä½œ
	(*p9)[0] += 1000
	*p91 += 1000
	log.Printf("æ•°ç»„[s9]å€¼: %+v", p9)
}

func CreateSliceTest() []int {
	s := make([]int, 1024)
	for i := 0; i < len(s); i++ {
		s[i] = i
	}
	return s
}

func CreateArrayTest() [1024]int {
	var a [1024]int
	for i := 0; i < len(a); i++ {
		a[i] = i
	}
	return a
}

/*
	é€šè¿‡åŸå§‹åˆ‡ç‰‡åˆ›å»ºæ–°åˆ‡ç‰‡æ—¶ï¼Œä¸å—lençš„é™åˆ¶ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡åŸæœ‰åˆ‡ç‰‡çš„cap
	+---+---+---+---+---+---+---+---+---+---+
	| 0 | 1 | 2 | 3 | 4 | 5 | 6 |   |   |   |      s             len: 6 cap: 10
	+---+---+---+---+---+---+---+---+---+---+
                  â†‘                   â†‘
	              3                   8
	            +---+---+---+---+---+---+---+
	            | 3 | 4 | 5 | 6 | 0 |   |   |      s1:=s[3:8]    len: 6 cap: 10
	            +---+---+---+---+---+---+---+
                          â†‘       â†‘       â†‘
                          2       4       6
	                    +---+---+---+---+
	                    | 5 | 6 |   |   |          s2:=s1[2:4:6] len: 6 cap: 10
	                    +---+---+---+---+
                          â†‘   â†‘
						  0   1
	                    +---+---+---+---+---+
	                    | 5 |   |   |   |   |      s3:=s2[:1:5]  len: 6 cap: 10 // è¶…è¿‡s2çš„capï¼Œäº§ç”Ÿpanic
	                    +---+---+---+---+---+
	ä¸‹é¢çš„å®éªŒå¯ä»¥çœ‹å‡ºå­sliceçš„å…ƒç´ åœ°å€å’Œçˆ¶sliceçš„åœ°å€å®Œå…¨ä¸€è‡´ï¼Œ
	ä¹Ÿå°±æ˜¯è¯´ï¼Œå­sliceçš„æ•°ç»„å…ƒç´ åªæ˜¯æŒ‡å‘äº†åŸsliceçš„æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆï¼Œå¹¶ä¸ä¼šäº§ç”Ÿæ•°æ®çš„å¤åˆ¶
*/
func ResliceTest() {
	s := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}
	printElementsAddress("s", &s)
	s1 := s[3:8]
	printElementsAddress("s1", &s1)
	s2 := s1[2:4:6]
	printElementsAddress("s2", &s2)
	// s3 := s2[:1:5] // slice bounds out of range [::5] with capacity 4
	log.Println(s)
	log.Println(s1)
	log.Println(s2)
	// log.Println(s3)
}

/*
	æ‰“å°æ‰€æœ‰å…ƒç´ çš„åœ°å€
	@param name å‚æ•°å
	@param slice åˆ‡ç‰‡æŒ‡é’ˆ
*/
func printElementsAddress(name string, slice *[]int) {
	log.Printf("'%s' [ ", name)
	for i := 0; i < len(*slice); i++ {
		log.Printf("slice[%d]: %p ", i, &(*slice)[i])
	}
	log.Println(" ]")
}

/*********** åˆ©ç”¨åˆ‡ç‰‡ç”Ÿäº§æ ˆå¼æ•°æ®ç»“æ„ ************/
func StackTest() {
	stack := make([]int, 0, 5)
	// å…¥æ ˆ
	push := func(x int) (idx int, err error) {
		err = nil
		l := len(stack)
		c := cap(stack)
		if l == c {
			idx = -1
			err = errors.New("stack is full")
			return idx, err
		}
		idx = l
		stack = stack[:l+1]
		stack[idx] = x
		return
	}
	// å‡ºæ ˆ
	pop := func() (e interface{}, err error) {
		err = nil
		l := len(stack)
		if l == 0 {
			err = errors.New("stack is empty")
			return nil, err
		}
		idx := l - 1
		e = stack[idx]
		stack = stack[:idx]
		return e, nil
	}

	for i := 0; i < 7; i++ {
		idx, err := push(i)
		if err != nil {
			log.Println("[push]: ", err)
		}
		log.Print("[push]: ", idx)
		log.Println("[push][stack]: ", stack)
	}

	for i := 7; i > 0; i-- {
		e, err := pop()
		if err != nil {
			log.Println("[pop]: ", err)
		}
		log.Println("[pop]: ", e)
		log.Println("[pop][stack]: ", stack)
	}
}

/*
	copyå‡½æ•°å¯ä»¥åœ¨ä¸¤ä¸ªåˆ‡ç‰‡å¯¹è±¡ä¹‹é—´è¿›è¡Œå¤åˆ¶ï¼Œå…è®¸æŒ‡å‘åŒä¸€åº•å±‚æ•°ç»„ï¼Œå…è®¸ç›®æ ‡åŒºé—´é‡å ã€‚
	æœ€ç»ˆæ‰€å¤åˆ¶é•¿åº¦ä»¥*è¾ƒçŸ­çš„*åˆ‡ç‰‡é•¿åº¦ä¸ºå‡†
	copy(dst,src)
*/
func SliceCopyTest() {
	s := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}
	log.Println("æ•°ç»„å˜é‡[s]å€¼ä¸º: ", s)
	s1 := s[5:8]
	log.Println("æ•°ç»„å˜é‡[s1]å€¼ä¸º: ", s1)
	// å°†s1çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°sï¼Œä»sçš„ç¬¬5ä¸ªå…ƒç´ è¦†ç›–
	n := copy(s[4:], s1)
	// æ‰“å°å¯ä»¥çœ‹åˆ°ï¼ŒåŸå§‹åˆ‡ç‰‡sï¼Œå­åˆ‡ç‰‡s1éƒ½æ”¶åˆ°äº†å½±å“ï¼Œè¿›ä¸€æ­¥è¯´æ˜ï¼Œå­åˆ‡ç‰‡ä¸çˆ¶åˆ‡ç‰‡çš„åº•å±‚æ•°ç»„ä¿æŒä¸€è‡´
	log.Println("æ‹·è´å…ƒç´ æ•°é‡ s1 -> s[4:] ä¸º: ", n)
	log.Println("æ•°ç»„å˜é‡[s]å€¼ä¸º: ", s)
	log.Println("æ•°ç»„å˜é‡[s1]å€¼ä¸º: ", s1)
	s2 := make([]int, 6)
	log.Println("æ•°ç»„å˜é‡[s2]å€¼ä¸º: ", s2)
	n = copy(s2, s)
	log.Println("æ‹·è´å…ƒç´ æ•°é‡ s -> s2 ä¸º: ", n)
	log.Println("æ•°ç»„å˜é‡[s]å€¼ä¸º: ", s)
	log.Println("æ•°ç»„å˜é‡[s2]å€¼ä¸º: ", s2)
}

/*
	Slice ä½œä¸ºå‚æ•°ä»ç„¶æ˜¯å€¼ä¼ é€’ï¼Œå¯ä»¥çœ‹åˆ°(sliceAsParamValue)Dataçš„åœ°å€æ˜¯ä¸åŒçš„ï¼Œåªæ˜¯éƒ½æŒ‡å‘äº†åŒä¸€ä¸ªæ•°ç»„
	è€ŒsliceAsParamAddrä¸­Dataçš„å€¼æ˜¯ç›¸åŒçš„
*/
func SliceAsParamTest() {
	s := make([]int, 0, 5)
	s = append(s, 1, 2, 3)

	log.Printf("[Address] First Element: %p, %+v", &s[0], s)
	header := (*reflect.SliceHeader)(unsafe.Pointer(&s))
	log.Printf("%+v", header)
	util.PrintSliceHeader(s, reflect.Int)
	sliceAsParamValue(s)
	// ğŸ‘‡ä¸‹é¢æ‰“å°å‡ºæ¥ Len: 3 è¯´æ˜ï¼Œè™½ç„¶åº•å±‚æ•°ç»„æ”¹å˜äº†ï¼Œä½†æ˜¯Lenå’ŒCapæ²¡æœ‰æ”¹å˜
	util.PrintSliceHeader(s, reflect.Int)
	log.Printf("%p, %d", &s[2], unsafe.Sizeof(1))
	// ğŸ‘‡ä½¿ç”¨ç‰¹æ®Šçš„æ–¹å¼è·å–åœ¨å‡½æ•°å†…æ”¹å˜çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ps = append(ps, 5)äº§ç”Ÿçš„å€¼
	// å¯ä»¥ç”¨è¿™ç§æ–¹å¼è®¿é—®ï¼Œä¹Ÿæ˜¯ç”±äºè¿™é‡Œmeke sliceçš„æœ€å¤§é•¿åº¦ä¸º5ï¼Œappendä¸ä¼šæ”¹å˜åŸæ•°ç»„çš„åœ°å€
	// é€šè¿‡åœ°å€è®¡ç®—å¯ä»¥è·å–æœ€åä¸€ä¸ªåœ¨å‡½æ•°ä¸­æ”¹å˜çš„ï¼Œè¯¥å‡½æ•°ä¸­ä¸å¯è§æ•°ç»„å…ƒç´ å€¼
	i := (unsafe.Pointer(uintptr(unsafe.Pointer(&s[2])) + unsafe.Sizeof(1)))
	log.Printf("%p, %d", i, *(*int)(i))
}

/*
	Slice æ˜¯å¼•ç”¨ä¼ é€’ï¼Œå€¼ä¼ é€’æ—¶å¤åˆ¶çš„æ˜¯Sliceå¤´ï¼Œå› æ­¤ä½¿ç”¨ slice[idx]ä¸‹æ ‡è®¿é—®æ•°æ®æ—¶ï¼Œæ˜¯å¯ä»¥æ”¹å˜åº•å±‚æ•°ç»„çš„å€¼
	ä½†æ˜¯ append ä¸è¡Œï¼Œappendä¼šæ”¹å˜sliceçš„é•¿åº¦ï¼Œé•¿åº¦æ˜¯åœ¨headerä¸­çš„ï¼Œå› æ­¤å¤–éƒ¨sliceçš„åº•å±‚æ•°ç»„ä»ç„¶æ— æ³•è®¿é—®åº•å±‚æ•°ç»„
	ç»“è®ºï¼šå¦‚æœæƒ³åœ¨å‡½æ•°ä¸­æ”¹å˜sliceçš„å€¼æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š
	1. ä¼ å…¥æŒ‡é’ˆï¼ˆä¸å¯è¡Œï¼Œå› ä¸ºç”±äºsliceæœ¬èº«å°±æ˜¯å¼•ç”¨ç±»å‹ï¼Œappendä¸èƒ½å¯¹sliceçš„æŒ‡é’ˆè¿›è¡Œæ“ä½œï¼Œä¹Ÿæ— æ³•ä½¿ç”¨æŒ‡é’ˆå–å€¼ï¼‰
	2. å¦‚æœä¸éœ€è¦æ‰©å®¹ï¼Œåœ¨LenèŒƒå›´å†…ä½¿ç”¨ä¸‹æ ‡èµ‹å€¼
	3. å¦‚æœè¦æ”¹å˜é•¿åº¦ï¼ˆä¾‹å¦‚ä½¿ç”¨appendæ‰©å®¹ï¼‰ï¼Œéœ€è¦è¿”å›æ–°çš„slice
*/
func sliceAsParamValue(ps []int) {
	log.Printf("%+v", ps)
	util.PrintSliceHeader(ps, reflect.Int)
	// ğŸ‘‡ç”±äºåº•å±‚æ•°ç»„æŒ‡é’ˆæ°¸è¿œæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªæ•°ç»„ï¼Œå› æ­¤åœ¨é•¿åº¦lenä»¥å†…æ”¹å˜æ•°ç»„çš„å€¼ä¹Ÿä¼šæ”¹å˜è°ƒç”¨è€…çš„sliceåº•å±‚çš„æ•°ç»„å€¼
	// è°ƒç”¨è¯¥å‡½æ•°çš„è°ƒç”¨è€…å¯ä»¥è·å–åˆ°å·²æ”¹å˜çš„å€¼ 4
	ps[2] = 4
	// ğŸ‘‡ç”±äºsliceé•¿åº¦æ˜¯3ï¼Œä¸‹é¢è¿™ä¸ªèµ‹å€¼ä¼šæŠ¥é”™
	// ps[3] = 4
	log.Printf("%p", &ps[2])
	// ğŸ‘‡ä¸‹é¢ä¸ä½†æ”¹å˜äº†åº•å±‚æ•°ç»„ï¼Œä¹Ÿæ”¹å˜äº†Lenå±æ€§ï¼Œä½†ç”±äºLenå±æ€§æ˜¯å‰¯æœ¬ï¼Œå› æ­¤å¤–éƒ¨å®é™…ä¼ å…¥çš„sliceå‚æ•°çš„Lenå’ŒCapæ²¡æœ‰æ”¹å˜
	ps = append(ps, 5)
	// ğŸ‘†è™½ç„¶åœ¨è¯¥å‡½æ•°ä¸­æ”¹å˜çš„å€¼5ï¼Œä½†åœ¨å¤–éƒ¨ç”¨å¯ä»¥ç‰¹æ®Šçš„æ–¹å¼å¯ä»¥è·å–åˆ°è¯¥å€¼
	util.PrintSliceHeader(ps, reflect.Int)
	log.Printf("%p,%p", &ps[2], &ps[3])
}
